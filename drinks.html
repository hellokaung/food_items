<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Drinks Menu - Refreshing Beverages</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="./css/bottom_navigation.css" />

    <style>
      body {
        font-family: "Poppins", sans-serif;
        background-color: #fffaf0; /* Warm White/Cream */
      }

      .no-scroll {
        overflow: hidden;
      }

      .menu-item {
        transition: transform 0.3s ease;
        background-color: #f5f5f5; /* Warm White/Cream */
      }

      .menu-item:hover {
        transform: translateY(-5px);
        box-shadow: 0 4px 12px rgba(85, 107, 47, 0.2); /* Olive Green shadow */
      }

      .category-btn {
        background-color: #f5f5f5; /* Warm White/Cream */
        color: #722f37; /* Deep Burgundy */
      }

      .category-btn.active {
        background-color: #e27d60; /* Soft Terracotta */
        color: #fffaf0; /* Warm White/Cream */
      }

      .category-btn:hover {
        background-color: #722f37; /* Deep Burgundy */
        color: #fffaf0; /* Warm White/Cream */
      }

      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(114, 47, 55, 0.5); /* Deep Burgundy with opacity */
        z-index: 1000;
      }

      .modal-content {
        background: #f5f5f5; /* Warm White/Cream */
        padding: 2rem;
        border-radius: 1rem;
        max-width: 800px;
        margin: 2rem auto;
      }

      .locked-content {
        filter: blur(5px);
        pointer-events: none;
      }

      .lock-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(114, 47, 55, 0.5); /* Deep Burgundy with opacity */
        display: flex;
        align-items: center;
        justify-content: center;
        color: #fffaf0; /* Warm White/Cream */
        font-size: 1.5rem;
        cursor: pointer;
      }

      #itemDetailModal {
        background: rgba(114, 47, 55, 0.5); /* Deep Burgundy with opacity */
      }

      #itemDetailModal .modal-content {
        background: #f5f5f5; /* Warm White/Cream */
      }
    </style>
  </head>

  <body>
    <!-- Navigation -->
    <nav class="bg-[#F5F5F5] shadow-md">
      <div class="container mx-auto px-4">
        <div class="flex justify-between items-center h-16">
          <div class="flex items-center">
            <a
              href="./"
              class="text-xl font-bold text-[#722F37] flex items-center gap-2"
            >
              <i class="fas fa-utensils"></i>
              <span>Food Menu</span>
            </a>
          </div>
          <!-- Mobile menu button -->

          <!-- Desktop Navigation -->
          <div class="hidden md:flex space-x-8 desktop-nav">
            <a
              href="food.html"
              class="text-[#556B2F] hover:text-[#E27D60] transition-colors"
              >Food</a
            >
            <a
              href="drinks.html"
              class="text-[#556B2F] hover:text-[#E27D60] transition-colors"
              >Drinks</a
            >
            <a
              href="recipes.html"
              class="text-[#556B2F] hover:text-[#E27D60] transition-colors"
              >Recipes</a
            >
            <a
              href="search.html"
              class="text-[#556B2F] hover:text-[#E27D60] transition-colors"
            >
              <i class="fas fa-search"></i> Search
            </a>
          </div>
          <div class="flex items-center space-x-4">
            <a
              href="cart.html"
              id="cartButton"
              class="relative p-2 rounded-full hover:bg-[#E27D60] hover:text-[#FFFAF0] transition-colors"
            >
              <i class="fas fa-shopping-cart text-[#556B2F]"></i>
              <span
                id="cartCount"
                class="absolute -top-1 -right-1 bg-[#722F37] text-[#FFFAF0] rounded-full w-5 h-5 flex items-center justify-center text-xs"
                >0</span
              >
            </a>
            <div id="google_translate_element"></div>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-12">
      <h1 class="text-4xl font-bold mb-8 text-center text-[#722F37]">
        Our Drinks Menu
      </h1>

      <!-- Category Navigation -->
      <div class="flex flex-wrap justify-center gap-4 mb-12">
        <button
          class="category-btn active px-6 py-2 rounded-full transition-colors"
          data-category="all"
        >
          All
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="soft-drinks"
        >
          Soft Drinks
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="fruit-juice"
        >
          Juices
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="fruit-shake"
        >
          Shakes
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="happy-hour"
        >
          Happy Hour
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="beer"
        >
          Beer
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="draft-beers"
        >
          Draft Beers
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="wine-glass"
        >
          Wine
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="classic-cocktail"
        >
          Classic Cocktails
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="mocktail"
        >
          Mocktails
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="signature-cocktail"
        >
          Signature Cocktails
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="spanish-cocktail"
        >
          Spanish Cocktails
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="gin-raw"
        >
          GinRaw Cocktails
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="gin-tonic"
        >
          Gin Tonic
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="vodka"
        >
          Vodka
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="rum"
        >
          Rum
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="whiskey"
        >
          Whiskey
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="liquers"
        >
          Liqueurs
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="brandy"
        >
          Brandy
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="shooter"
        >
          Shooters
        </button>
        <button
          class="category-btn px-6 py-2 rounded-full transition-colors"
          data-category="special"
        >
          Specials
        </button>
      </div>

      <!-- Drinks Items Grid -->
      <div
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"
        id="drinksGrid"
      >
        <!-- Items will be dynamically inserted here -->
      </div>
    </main>

    <!-- Fullscreen Item Detail Modal -->
    <div
      id="itemDetailModal"
      class="modal hidden flex items-center justify-center"
    >
      <div
        class="modal-content relative w-full h-full max-w-lg overflow-hidden flex flex-col"
      >
        <!-- Header -->
        <div
          class="flex justify-between items-start p-4 border-b border-[#556B2F]"
        >
          <h3 class="text-2xl font-bold text-[#722F37]" id="detailTitle"></h3>
          <button
            id="closeDetailModal"
            class="text-[#556B2F] hover:text-[#E27D60]"
          >
            <i class="fas fa-times text-xl"></i>
          </button>
        </div>

        <!-- Scrollable Content -->
        <div class="flex-1 overflow-y-auto p-4 space-y-4">
          <img
            id="detailImage"
            src=""
            alt=""
            class="w-full h-64 object-cover rounded-lg"
          />
          <p id="detailDescription" class="text-[#556B2F]"></p>
          <div id="detailPrice" class="text-xl font-bold text-[#E27D60]"></div>
          <div id="detailIngredients">
            <h4 class="font-semibold mb-1 text-[#722F37]">Ingredients:</h4>
            <ul
              id="ingredientsList"
              class="list-disc list-inside text-[#556B2F]"
            ></ul>
          </div>
          <div id="detailInstructions">
            <h4 class="font-semibold mb-1 text-[#722F37]">Instructions:</h4>
            <p id="instructionsText" class="text-[#556B2F]"></p>
          </div>
        </div>

        <!-- Sticky Add to Cart Button -->
        <div class="p-4 border-t bg-[#F5F5F5] sticky bottom-0 z-10">
          <button
            id="addToCartDetail"
            class="w-full px-4 py-2 bg-[#E27D60] text-[#FFFAF0] rounded-lg hover:bg-[#722F37] transition-colors"
          >
            Add to Cart
          </button>
        </div>
      </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
      <div class="modal-content max-w-md">
        <h3 class="text-xl font-bold mb-4 text-[#722F37]">Enter Password</h3>
        <input
          type="password"
          id="passwordInput"
          class="w-full p-2 border border-[#556B2F] rounded mb-4 bg-[#FFFAF0] text-[#722F37]"
          placeholder="Enter password"
        />
        <div class="flex justify-end space-x-4">
          <button
            id="cancelPassword"
            class="px-4 py-2 bg-[#556B2F] text-[#FFFAF0] rounded hover:bg-[#722F37]"
          >
            Cancel
          </button>
          <button
            id="submitPassword"
            class="px-4 py-2 bg-[#E27D60] text-[#FFFAF0] rounded hover:bg-[#722F37]"
          >
            Submit
          </button>
        </div>
      </div>
    </div>
    <div class="flex lg:hidden h-28"></div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <a href="food.html" class="bottom-nav-item" tabindex="0">
        <div class="nav-icon-wrapper">
          <i class="fas fa-utensils"></i>
        </div>
        <span>Food</span>
      </a>
      <a href="drinks.html" class="bottom-nav-item active" tabindex="0">
        <div class="nav-icon-wrapper">
          <i class="fas fa-cocktail"></i>
        </div>
        <span>Drinks</span>
      </a>
      <a href="cart.html" class="bottom-nav-item" tabindex="0">
        <div class="nav-icon-wrapper">
          <i class="fas fa-shopping-cart"></i>
        </div>
        <span>Cart</span>
      </a>
      <a href="search.html" class="bottom-nav-item" tabindex="0">
        <div class="nav-icon-wrapper">
          <i class="fas fa-search"></i>
        </div>
        <span>Search</span>
      </a>
    </div>

    <script type="text/javascript">
      function googleTranslateElementInit() {
        new google.translate.TranslateElement(
          { pageLanguage: "en" },
          "google_translate_element"
        );
      }
    </script>
    <script
      type="text/javascript"
      src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"
    ></script>

    <script type="module">
      import { drinksData } from "./data/drinks_data.js";

      // Utility to generate UUID
      function generateUUID() {
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(
          /[xy]/g,
          function (c) {
            const r = (Math.random() * 16) | 0,
              v = c === "x" ? r : (r & 0x3) | 0x8;
            return v.toString(16);
          }
        );
      }

      // Cart functionality
      let cart = JSON.parse(localStorage.getItem("cart")) || [];

      function updateCartCount() {
        try {
          const cartCount = document.getElementById("cartCount");
          if (!cartCount) throw new Error("Cart count element missing");
          const totalItems = cart.reduce(
            (sum, item) => sum + (item.quantity || 1),
            0
          );
          cartCount.textContent = totalItems;
        } catch (error) {
          console.error("Error in updateCartCount:", error);
        }
      }

      function addToCart(item) {
        try {
          // Create a new item object with a unique ID
          const cartItem = {
            id: item.id || generateUUID(),
            name: item.name,
            price: item.price,
            image: item.image,
            description: item.description,
            quantity: 1,
            ingredients: item.ingredients || [],
            instructions: item.instructions || "",
          };

          const existingItem = cart.find(
            (cartItem) => cartItem.name === item.name
          );
          if (existingItem) {
            existingItem.quantity += 1;
          } else {
            cart.push(cartItem);
          }

          localStorage.setItem("cart", JSON.stringify(cart));
          updateCartCount();
          showSuccessMessage(cartItem);
        } catch (error) {
          console.error("Error in addToCart:", error);
        }
      }

      function showSuccessMessage(item) {
        try {
          const message = document.createElement("div");
          message.textContent = `${item.name} added to cart!`;
          message.className =
            "fixed top-4 right-4 bg-[#556B2F] text-[#FFFAF0] px-4 py-2 rounded-lg shadow-lg z-50";
          document.body.appendChild(message);
          setTimeout(() => {
            message.remove();
          }, 2000);
        } catch (error) {
          console.error("Error in showSuccessMessage:", error);
        }
      }

      // Display drinks
      function displayDrinks(category = "all") {
        try {
          const drinksGrid = document.getElementById("drinksGrid");
          if (!drinksGrid) throw new Error("Drinks grid element missing");

          drinksGrid.innerHTML = "";

          let drinksToShow = [];
          if (category === "all") {
            Object.values(drinksData).forEach((categoryDrinks) => {
              drinksToShow = drinksToShow.concat(categoryDrinks);
            });
          } else {
            drinksToShow = drinksData[category] || [];
          }

          drinksToShow.forEach((drink) => {
            const drinkCard = document.createElement("div");
            drinkCard.className = "menu-item rounded-lg shadow-md relative";
            drinkCard.innerHTML = `
              <div class="relative">
                <img src="${drink.image}" alt="${
              drink.name
            }" class="w-full h-48 object-cover rounded-t-lg">
                ${
                  drink.locked
                    ? `<div class="lock-overlay"><i class="fas fa-lock"></i> Unlock to view</div>`
                    : ""
                }
              </div>
              <div class="p-4 ${drink.locked ? "locked-content" : ""}">
                <h3 class="text-lg font-semibold text-[#722F37]">${
                  drink.name
                }</h3>
                <p class="text-[#556B2F]">${drink.description}</p>
                <p class="text-[#E27D60] font-bold mt-2">฿${drink.price}</p>
                <button class="mt-4 px-4 py-2 bg-[#E27D60] text-[#FFFAF0] rounded hover:bg-[#722F37] transition-colors add-to-cart" ${
                  drink.locked ? "disabled" : ""
                }>Add to Cart</button>
              </div>
            `;
            drinksGrid.appendChild(drinkCard);

            if (!drink.locked) {
              drinkCard
                .querySelector(".add-to-cart")
                .addEventListener("click", () => addToCart(drink));
              drinkCard.addEventListener("click", (e) => {
                if (!e.target.classList.contains("add-to-cart")) {
                  showItemDetail(drink);
                }
              });
            } else {
              drinkCard.addEventListener("click", showPasswordModal);
            }
          });
        } catch (error) {
          console.error("Error in displayDrinks:", error);
        }
      }

      // Category filtering
      document.querySelectorAll(".category-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          document
            .querySelectorAll(".category-btn")
            .forEach((b) => b.classList.remove("active"));
          btn.classList.add("active");
          const category = btn.getAttribute("data-category");
          displayDrinks(category);
        });
      });

      // Item detail modal
      function showItemDetail(item) {
        try {
          const modal = document.getElementById("itemDetailModal");
          const addToCartBtn = document.getElementById("addToCartDetail");
          if (!modal) throw new Error("Item detail modal missing");

          document.getElementById("detailTitle").textContent = item.name;
          document.getElementById("detailDescription").textContent =
            item.description;
          document.getElementById("detailPrice").textContent = `฿${item.price}`;
          document.getElementById("detailImage").src = item.image;
          document.getElementById("detailImage").alt = item.name;

          const ingredientsList = document.getElementById("ingredientsList");
          if (item.ingredients && item.ingredients.length > 0) {
            const ingredientsHTML = item.ingredients
              .map((ingredient) => {
                const searchQuery = encodeURIComponent(ingredient);
                return `<li><a href="https://www.google.com/search?q=${searchQuery}&tbm=isch" target="_blank" class="text-[#E27D60] hover:text-[#722F37]">${ingredient}</a></li>`;
              })
              .join("");
            ingredientsList.innerHTML = ingredientsHTML;
            document.getElementById("detailIngredients").style.display =
              "block";
          } else {
            document.getElementById("detailIngredients").style.display = "none";
          }

          document.getElementById("instructionsText").textContent =
            item.instructions || "No instructions provided.";

          modal.classList.remove("hidden");
          document.body.classList.add("no-scroll");
          // Close detail modal
          document
            .getElementById("closeDetailModal")
            .addEventListener("click", () => {
              document
                .getElementById("itemDetailModal")
                .classList.add("hidden");
              document.body.classList.remove("no-scroll");
            });

          // Close modal when clicking outside
          window.addEventListener("click", (event) => {
            const modal = document.getElementById("itemDetailModal");
            if (event.target === modal) {
              modal.classList.add("hidden");
              document.body.classList.remove("no-scroll");
            }
          });
          // Add to cart functionality
          if (item.price) {
            addToCartBtn.onclick = (e) => {
              e.preventDefault();
              e.stopPropagation();
              addToCart(item);
              modal.classList.add("hidden");
              document.body.classList.remove("no-scroll");
            };
          }
        } catch (error) {
          console.error("Error in showItemDetail:", error);
        }
      }

      // Password modal
      function showPasswordModal() {
        try {
          const passwordModal = document.getElementById("passwordModal");
          if (!passwordModal) throw new Error("Password modal missing");
          passwordModal.style.display = "flex";
          document.body.classList.add("no-scroll");
          document.getElementById("passwordInput").focus();
        } catch (error) {
          console.error("Error in showPasswordModal:", error);
        }
      }

      document
        .getElementById("cancelPassword")
        .addEventListener("click", () => {
          try {
            const passwordModal = document.getElementById("passwordModal");
            if (!passwordModal) throw new Error("Password modal missing");
            passwordModal.style.display = "none";
            document.body.classList.remove("no-scroll");
            document.getElementById("passwordInput").value = "";
          } catch (error) {
            console.error("Error in cancelPassword:", error);
          }
        });

      document
        .getElementById("submitPassword")
        .addEventListener("click", () => {
          try {
            const password = document.getElementById("passwordInput").value;
            if (password === "unlock123") {
              Object.keys(drinksData).forEach((category) => {
                drinksData[category].forEach((drink) => {
                  drink.locked = false;
                });
              });
              displayDrinks(
                document
                  .querySelector(".category-btn.active")
                  .getAttribute("data-category")
              );
              document.getElementById("passwordModal").style.display = "none";
              document.body.classList.remove("no-scroll");
              document.getElementById("passwordInput").value = "";
            } else {
              alert("Incorrect password");
            }
          } catch (error) {
            console.error("Error in submitPassword:", error);
          }
        });

      // Initialize
      document.addEventListener("DOMContentLoaded", () => {
        try {
          displayDrinks();
          updateCartCount();

          // Bottom navigation active state and touch feedback
          const currentPath =
            window.location.pathname.split("/").pop() || "index.html";
          const bottomNavItems = document.querySelectorAll(".bottom-nav-item");

          bottomNavItems.forEach((item) => {
            const href = item.getAttribute("href");
            if (href === currentPath) {
              item.classList.add("active");
              item.style.color = "#E27D60";
            } else {
              item.style.color = "#556B2F";
            }

            item.addEventListener("touchstart", () => {
              item.classList.add("touch-active");
              item.style.color = "#FFFAF0";
            });

            item.addEventListener("touchend", () => {
              setTimeout(() => {
                item.classList.remove("touch-active");
                if (href === currentPath) {
                  item.style.color = "#E27D60";
                } else {
                  item.style.color = "#556B2F";
                }
              }, 100);
            });

            item.addEventListener("keydown", (e) => {
              if (e.key === "Enter") {
                window.location.href = item.getAttribute("href");
              }
            });
          });
        } catch (error) {
          console.error("Error in DOMContentLoaded:", error);
        }
      });
    </script>
  </body>
</html>
